<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SM2 ååŒç­¾åå®¢æˆ·ç«¯ - æŠ€æœ¯æ–‡æ¡£</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        header {
            background: linear-gradient(135deg, #CE422B 0%, #A33D2B 100%);
            color: white;
            padding: 60px 20px;
            text-align: center;
        }
        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        .badges {
            margin-top: 20px;
        }
        .badges img {
            margin: 0 5px;
        }
        nav {
            background: #fff;
            padding: 15px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        nav ul {
            list-style: none;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
        }
        nav li {
            margin: 0 15px;
        }
        nav a {
            text-decoration: none;
            color: #CE422B;
            font-weight: 500;
            transition: color 0.3s;
        }
        nav a:hover {
            color: #A33D2B;
        }
        section {
            background: #fff;
            margin: 20px 0;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        h2 {
            color: #CE422B;
            border-bottom: 2px solid #CE422B;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        h3 {
            color: #333;
            margin: 20px 0 10px;
        }
        h4 {
            color: #A33D2B;
            margin: 15px 0 10px;
        }
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .feature-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #CE422B;
        }
        .feature-card h4 {
            color: #CE422B;
            margin-bottom: 10px;
        }
        .tech-stack {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }
        .tech-badge {
            background: #CE422B;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
        }
        pre {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 15px 0;
        }
        code {
            font-family: 'Fira Code', 'Consolas', monospace;
        }
        .inline-code {
            background: #e9ecef;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.9em;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background: #CE422B;
            color: white;
        }
        tr:hover {
            background: #f5f5f5;
        }
        .diagram {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            font-family: monospace;
            white-space: pre;
            overflow-x: auto;
            font-size: 0.85em;
            line-height: 1.4;
        }
        .btn {
            display: inline-block;
            background: #CE422B;
            color: white;
            padding: 10px 25px;
            border-radius: 25px;
            text-decoration: none;
            margin: 5px;
            transition: background 0.3s;
        }
        .btn:hover {
            background: #A33D2B;
        }
        .btn-outline {
            background: transparent;
            border: 2px solid #CE422B;
            color: #CE422B;
        }
        .btn-outline:hover {
            background: #CE422B;
            color: white;
        }
        footer {
            text-align: center;
            padding: 40px;
            color: #666;
            border-top: 1px solid #ddd;
        }
        .warning-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        .info-box {
            background: #d1ecf1;
            border-left: 4px solid #17a2b8;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        .rust-keyword {
            color: #CE422B;
            font-weight: bold;
        }
        .architecture-box {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .comparison-table {
            margin: 20px 0;
        }
        .comparison-table th:first-child {
            background: #6c757d;
        }
        @media (max-width: 768px) {
            header h1 {
                font-size: 1.8em;
            }
            section {
                padding: 20px;
            }
            nav ul {
                flex-direction: column;
                align-items: center;
            }
            nav li {
                margin: 5px 0;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>ğŸ¦€ SM2 ååŒç­¾åå®¢æˆ·ç«¯</h1>
        <p>åŸºäº Rust å®ç°çš„å›½å¯† SM2 ååŒç­¾åå®¢æˆ·ç«¯</p>
        <div class="badges">
            <img src="https://img.shields.io/badge/License-MIT-blue.svg" alt="License">
            <img src="https://img.shields.io/badge/Rust-1.70+-CE422B?logo=rust" alt="Rust">
            <img src="https://img.shields.io/badge/Tokio-1.0-CE422B" alt="Tokio">
            <img src="https://img.shields.io/badge/SM2-å›½å¯†æ ‡å‡†-green" alt="SM2">
        </div>
    </header>

    <nav>
        <ul>
            <li><a href="#overview">æ¦‚è¿°</a></li>
            <li><a href="#architecture">æ¶æ„è®¾è®¡</a></li>
            <li><a href="#protocol">åè®®åŸç†</a></li>
            <li><a href="#api">API æ–‡æ¡£</a></li>
            <li><a href="#ffi">FFI æ¥å£</a></li>
            <li><a href="#performance">æ€§èƒ½æµ‹è¯•</a></li>
            <li><a href="#security">å®‰å…¨æœºåˆ¶</a></li>
            <li><a href="#license">è®¸å¯è¯</a></li>
        </ul>
    </nav>

    <div class="container">
        <section id="overview">
            <h2>ğŸ“‹ æ¦‚è¿°</h2>
            <p>SM2 ååŒç­¾åå®¢æˆ·ç«¯æ˜¯ååŒç­¾åç³»ç»Ÿçš„ç”¨æˆ·ç«¯ç»„ä»¶ï¼Œè´Ÿè´£ç®¡ç†å®¢æˆ·ç«¯å¯†é’¥åˆ†é‡ D1ï¼Œä¸æœåŠ¡ç«¯åä½œå®Œæˆç­¾åå’Œè§£å¯†æ“ä½œã€‚é‡‡ç”¨ Rust è¯­è¨€å®ç°ï¼Œç¡®ä¿å†…å­˜å®‰å…¨å’Œé«˜æ€§èƒ½ã€‚</p>
            
            <div class="info-box">
                <strong>æ ¸å¿ƒèŒè´£ï¼š</strong>å­˜å‚¨å®¢æˆ·ç«¯å¯†é’¥åˆ†é‡ D1ï¼Œå‘èµ·ååŒç­¾å/è§£å¯†è¯·æ±‚ï¼Œç¡®ä¿ç§é’¥æ°¸ä¸å®Œæ•´å‡ºç°ã€‚
            </div>

            <h3>ä»€ä¹ˆæ˜¯ååŒç­¾åï¼Ÿ</h3>
            <p>ååŒç­¾åï¼ˆCo-Signatureï¼‰æ˜¯ä¸€ç§åˆ†å¸ƒå¼å¯†ç å­¦æŠ€æœ¯ï¼Œå°†ç§é’¥åˆ†å‰²ä¸ºå¤šä¸ªåˆ†é‡ï¼Œç”±ä¸åŒæ–¹åˆ†åˆ«æŒæœ‰ã€‚ç­¾åæ—¶ï¼Œå„æ–¹åä½œå®Œæˆç­¾åè®¡ç®—ï¼Œä½†ä»»ä½•ä¸€æ–¹éƒ½æ— æ³•å•ç‹¬è·å–å®Œæ•´ç§é’¥ã€‚</p>

            <h3>ä¼ ç»Ÿç­¾å vs ååŒç­¾å</h3>
            <table class="comparison-table">
                <tr>
                    <th>ç‰¹æ€§</th>
                    <th>ä¼ ç»Ÿç­¾å</th>
                    <th>ååŒç­¾å</th>
                </tr>
                <tr>
                    <td>ç§é’¥å­˜å‚¨</td>
                    <td>å•ç‚¹å­˜å‚¨ï¼Œé£é™©é«˜</td>
                    <td>åˆ†ç‰‡å­˜å‚¨ï¼Œå®‰å…¨é«˜</td>
                </tr>
                <tr>
                    <td>ç­¾åè¿‡ç¨‹</td>
                    <td>å•æ–¹å®Œæˆ</td>
                    <td>å¤šæ–¹åä½œ</td>
                </tr>
                <tr>
                    <td>å¯†é’¥æ³„éœ²é£é™©</td>
                    <td>é«˜</td>
                    <td>ä½ï¼ˆéœ€å¤šæ–¹åŒæ—¶æ³„éœ²ï¼‰</td>
                </tr>
                <tr>
                    <td>åˆè§„æ€§</td>
                    <td>éœ€é¢å¤–æªæ–½</td>
                    <td>å¤©ç„¶æ»¡è¶³ç›‘ç®¡è¦æ±‚</td>
                </tr>
            </table>

            <h3>æŠ€æœ¯æ ˆ</h3>
            <div class="tech-stack">
                <span class="tech-badge">Rust 2021</span>
                <span class="tech-badge">Tokio 1.0</span>
                <span class="tech-badge">libsm 0.5</span>
                <span class="tech-badge">gm-sdk-rs</span>
                <span class="tech-badge">reqwest</span>
                <span class="tech-badge">clap 4.0</span>
            </div>

            <h3>æ ¸å¿ƒä¾èµ–</h3>
            <table>
                <tr>
                    <th>ä¾èµ–</th>
                    <th>ç‰ˆæœ¬</th>
                    <th>ç”¨é€”</th>
                </tr>
                <tr>
                    <td><code>libsm</code></td>
                    <td>0.5</td>
                    <td>SM2 æ¤­åœ†æ›²çº¿åº•å±‚æ“ä½œã€åŠ è§£å¯†ã€KDF</td>
                </tr>
                <tr>
                    <td><code>gm-sdk-rs</code></td>
                    <td>git</td>
                    <td>SM2 æ ‡å‡†ç­¾åéªŒç­¾ã€SM3 å“ˆå¸Œ</td>
                </tr>
                <tr>
                    <td><code>tokio</code></td>
                    <td>1.0</td>
                    <td>å¼‚æ­¥è¿è¡Œæ—¶</td>
                </tr>
                <tr>
                    <td><code>reqwest</code></td>
                    <td>0.11</td>
                    <td>HTTP å®¢æˆ·ç«¯</td>
                </tr>
                <tr>
                    <td><code>clap</code></td>
                    <td>4.0</td>
                    <td>CLI æ¡†æ¶</td>
                </tr>
            </table>
        </section>

        <section id="architecture">
            <h2>ğŸ—ï¸ æ¶æ„è®¾è®¡</h2>
            
            <h3>æ¨¡å—ç»“æ„</h3>
            <div class="diagram">
client/
â”œâ”€â”€ Cargo.toml                    # å·¥ä½œç©ºé—´é…ç½®
â”œâ”€â”€ sm2_co_sign_core/             # æ ¸å¿ƒåè®®åº“
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ lib.rs               # åº“å…¥å£
â”‚   â”‚   â”œâ”€â”€ client.rs            # HTTP å®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ protocol.rs          # ååŒç­¾ååè®®
â”‚   â”‚   â”œâ”€â”€ types.rs             # ç±»å‹å®šä¹‰
â”‚   â”‚   â””â”€â”€ error.rs             # é”™è¯¯å¤„ç†
â”‚   â””â”€â”€ tests/
â”‚       â””â”€â”€ integration_test.rs  # é›†æˆæµ‹è¯•
â”œâ”€â”€ sm2_co_sign_cli/              # å‘½ä»¤è¡Œå·¥å…·
â”‚   â””â”€â”€ src/main.rs
â”œâ”€â”€ sm2_co_sign_ffi/              # FFI ç»‘å®š
â”‚   â””â”€â”€ src/lib.rs
â””â”€â”€ docs/                         # æ–‡æ¡£
    â”œâ”€â”€ index.html
    â””â”€â”€ TECH_NOTES.md
            </div>

            <h3>ç³»ç»Ÿæ¶æ„</h3>
            <div class="architecture-box">
                <div class="diagram">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        åº”ç”¨å±‚                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   CLI å·¥å…·      â”‚   Rust API     â”‚      FFI åŠ¨æ€åº“              â”‚
â”‚  sm2-cosign     â”‚  CoSignClient  â”‚  libsm2_co_sign_ffi.so       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        æ ¸å¿ƒåè®®å±‚                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    CoSignProtocol                        â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚ å¯†é’¥ç”Ÿæˆ  â”‚  â”‚ ååŒç­¾å  â”‚  â”‚    ååŒè§£å¯†       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  D1/D2    â”‚  â”‚  K1/K2/K3 â”‚  â”‚    T1/T2          â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        å¯†ç ç®—æ³•å±‚                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚      gm-sdk-rs      â”‚  â”‚             libsm               â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”   â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚ SM2 â”‚ â”‚ SM3 â”‚   â”‚  â”‚  â”‚ ç‚¹ä¹˜è¿ç®— â”‚ â”‚ SM2 åŠ è§£å¯†    â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ç­¾å â”‚ â”‚ å“ˆå¸Œ â”‚   â”‚  â”‚  â”‚ ç‚¹åŠ è¿ç®— â”‚ â”‚ KDF å¯†é’¥æ´¾ç”Ÿ  â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜   â”‚  â”‚  â”‚ åæ ‡è½¬æ¢ â”‚ â”‚ ååŒç­¾åè®¡ç®—  â”‚ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        ç½‘ç»œé€šä¿¡å±‚                                â”‚
â”‚                    reqwest + tokio                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                </div>
            </div>

            <h3>åº“èŒè´£åˆ†å·¥</h3>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>ğŸ“¦ gm-sdk-rs</h4>
                    <p>SM3 å“ˆå¸Œã€SM2 æ ‡å‡†ç­¾åéªŒç­¾<br>API ç®€æ´ï¼Œå¼€ç®±å³ç”¨</p>
                </div>
                <div class="feature-card">
                    <h4>ğŸ”§ libsm</h4>
                    <p>æ¤­åœ†æ›²çº¿ç‚¹ä¹˜ã€SM2 åŠ è§£å¯†ã€KDF<br>æ”¯æŒååŒç­¾åç‰¹æœ‰æ“ä½œ</p>
                </div>
            </div>
        </section>

        <section id="protocol">
            <h2>ğŸ” åè®®åŸç†</h2>
            
            <h3>å¯†é’¥ç”Ÿæˆåè®®</h3>
            <div class="diagram">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    å®¢æˆ·ç«¯     â”‚                                    â”‚    æœåŠ¡ç«¯     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                                                   â”‚
       â”‚  1. ç”Ÿæˆéšæœºæ•° d1 âˆˆ [1, n-1]                       â”‚
       â”‚  2. è®¡ç®— P1 = d1 Â· G                              â”‚
       â”‚                                                   â”‚
       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å‘é€ P1 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
       â”‚                                                   â”‚
       â”‚                                    3. ç”Ÿæˆéšæœºæ•° d2
       â”‚                                    4. è®¡ç®— d2Inv = d2â»Â¹ mod n
       â”‚                                    5. è®¡ç®— Pa = d2Inv Â· P1 - G
       â”‚                                    6. å­˜å‚¨ (userId, d2, d2Inv, Pa)
       â”‚                                                   â”‚
       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ è¿”å› (P2, Pa) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
       â”‚                                                   â”‚
       â”‚  7. è®¡ç®—å®Œæ•´ç§é’¥ d = d1 Â· d2 - 1                   â”‚
       â”‚  8. å­˜å‚¨ (d1, userId, Pa)                         â”‚
       â”‚                                                   â”‚
            </div>

            <h3>ååŒç­¾ååè®®</h3>
            <div class="diagram">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    å®¢æˆ·ç«¯     â”‚                                    â”‚    æœåŠ¡ç«¯     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                                                   â”‚
       â”‚  1. è®¡ç®—æ¶ˆæ¯å“ˆå¸Œ E = SM3(M)                        â”‚
       â”‚  2. ç”Ÿæˆéšæœºæ•° k1 âˆˆ [1, n-1]                       â”‚
       â”‚  3. è®¡ç®— Q1 = k1 Â· G                              â”‚
       â”‚                                                   â”‚
       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å‘é€ (Q1, E) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
       â”‚                                                   â”‚
       â”‚                                    4. ç”Ÿæˆéšæœºæ•° k2, k3
       â”‚                                    5. è®¡ç®— r = (E + x1) mod n
       â”‚                                    6. è®¡ç®— s2, s3
       â”‚                                                   â”‚
       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ è¿”å› (r, s2, s3) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
       â”‚                                                   â”‚
       â”‚  7. è®¡ç®— s1 = k1 Â· s3 - r Â· d1 mod n              â”‚
       â”‚  8. è®¡ç®— s = s1 Â· s2 mod n                        â”‚
       â”‚  9. è¾“å‡ºç­¾å (r, s)                               â”‚
       â”‚                                                   â”‚
            </div>

            <h3>æ•°å­¦åŸç†</h3>
            <div class="info-box">
                <strong>å®Œæ•´ç§é’¥æ¨å¯¼ï¼š</strong><br>
                Pa = d2Inv Â· P1 - G = d2â»Â¹ Â· (d1 Â· G) - G = (d1 Â· d2â»Â¹ - 1) Â· G<br>
                å› æ­¤ï¼šd = d1 Â· d2 - 1 (mod n)<br><br>
                <strong>éªŒè¯ï¼š</strong>Pa = d Â· G âœ“
            </div>
        </section>

        <section id="api">
            <h2>ğŸ“¡ API æ–‡æ¡£</h2>
            
            <h3>CoSignProtocol - æ ¸å¿ƒåè®®</h3>
            <table>
                <tr><th>æ–¹æ³•</th><th>è¯´æ˜</th><th>è¿”å›å€¼</th></tr>
                <tr><td><code>new()</code></td><td>åˆ›å»ºåè®®å®ä¾‹</td><td><code>Result&lt;Self&gt;</code></td></tr>
                <tr><td><code>generate_d1()</code></td><td>ç”Ÿæˆç§é’¥åˆ†é‡ D1</td><td><code>Result&lt;Vec&lt;u8&gt;&gt;</code></td></tr>
                <tr><td><code>calculate_p1(d1)</code></td><td>è®¡ç®—å…¬é’¥ P1 = D1 * G</td><td><code>Result&lt;Vec&lt;u8&gt;&gt;</code></td></tr>
                <tr><td><code>sign_prepare()</code></td><td>ç­¾åé¢„å¤„ç†</td><td><code>Result&lt;(K1, Q1)&gt;</code></td></tr>
                <tr><td><code>complete_signature(...)</code></td><td>å®Œæˆç­¾åè®¡ç®—</td><td><code>Result&lt;(R, S)&gt;</code></td></tr>
                <tr><td><code>sm3_hash(data)</code></td><td>SM3 å“ˆå¸Œ</td><td><code>Vec&lt;u8&gt;</code></td></tr>
                <tr><td><code>sign(sk, msg)</code></td><td>SM2 æ ‡å‡†ç­¾å</td><td><code>Result&lt;Vec&lt;u8&gt;&gt;</code></td></tr>
                <tr><td><code>verify(pk, msg, sig)</code></td><td>SM2 æ ‡å‡†éªŒç­¾</td><td><code>Result&lt;bool&gt;</code></td></tr>
                <tr><td><code>encrypt(pk, msg)</code></td><td>SM2 åŠ å¯†</td><td><code>Result&lt;Vec&lt;u8&gt;&gt;</code></td></tr>
                <tr><td><code>decrypt(sk, cipher)</code></td><td>SM2 è§£å¯†</td><td><code>Result&lt;Option&lt;Vec&lt;u8&gt;&gt;&gt;</code></td></tr>
            </table>

            <h3>CoSignClient - HTTP å®¢æˆ·ç«¯</h3>
            <table>
                <tr><th>æ–¹æ³•</th><th>è¯´æ˜</th><th>è¿”å›å€¼</th></tr>
                <tr><td><code>new(config)</code></td><td>åˆ›å»ºå®¢æˆ·ç«¯</td><td><code>Result&lt;Self&gt;</code></td></tr>
                <tr><td><code>register(username, password)</code></td><td>ç”¨æˆ·æ³¨å†Œ</td><td><code>Result&lt;KeyPair&gt;</code></td></tr>
                <tr><td><code>login(username, password)</code></td><td>ç”¨æˆ·ç™»å½•</td><td><code>Result&lt;Session&gt;</code></td></tr>
                <tr><td><code>logout()</code></td><td>ç”¨æˆ·ç™»å‡º</td><td><code>Result&lt;()&gt;</code></td></tr>
                <tr><td><code>sign(message)</code></td><td>ååŒç­¾å</td><td><code>Result&lt;Signature&gt;</code></td></tr>
                <tr><td><code>decrypt(ciphertext)</code></td><td>ååŒè§£å¯†</td><td><code>Result&lt;Vec&lt;u8&gt;&gt;</code></td></tr>
            </table>

            <h3>ä»£ç ç¤ºä¾‹</h3>
            <pre><code>use sm2_co_sign_core::{CoSignClient, ClientConfig};

#[tokio::main]
async fn main() -> Result<(), Box<dyn std::error::Error>> {
    let config = ClientConfig {
        server_url: "http://127.0.0.1:9002".to_string(),
        timeout: 30,
        verify_tls: false,
    };
    
    let client = CoSignClient::new(config)?;
    
    // ç”¨æˆ·æ³¨å†Œ
    let key_pair = client.register("alice", "password").await?;
    println!("ç”¨æˆ·ID: {}", key_pair.user_id);
    
    // ç”¨æˆ·ç™»å½•
    let session = client.login("alice", "password").await?;
    
    // ååŒç­¾å
    let signature = client.sign(b"Hello, SM2!").await?;
    println!("ç­¾å: {:02x?}", signature.r);
    
    Ok(())
}</code></pre>
        </section>

        <section id="ffi">
            <h2>ğŸ”Œ FFI æ¥å£</h2>
            
            <h3>ç¼–è¯‘åŠ¨æ€åº“</h3>
            <pre><code># Linux/macOS
cargo build --release --lib -p sm2_co_sign_ffi

# æ„å»ºäº§ç‰©
# Linux:   target/release/libsm2_co_sign_ffi.so
# macOS:   target/release/libsm2_co_sign_ffi.dylib
# Windows: target/release/sm2_co_sign_ffi.dll</code></pre>

            <h3>C æ¥å£å‡½æ•°</h3>
            <pre><code>// ä¸Šä¸‹æ–‡ç®¡ç†
CoSignContext* cosign_context_new(void);
void cosign_context_free(CoSignContext* ctx);

// å¯†é’¥æ“ä½œ
int cosign_generate_d1(CoSignContext* ctx, uint8_t* out_d1, unsigned long* out_len);
int cosign_calculate_p1(const CoSignContext* ctx, const uint8_t* d1, unsigned long d1_len,
                        uint8_t* out_p1, unsigned long* out_len);

// SM2 æ ‡å‡†æ“ä½œ
int cosign_sm3_hash(const uint8_t* data, unsigned long data_len,
                    uint8_t* out_hash, unsigned long* out_len);
int cosign_sm2_sign(const uint8_t* private_key, unsigned long private_key_len,
                    const uint8_t* message, unsigned long message_len,
                    uint8_t* out_signature, unsigned long* out_len);
int cosign_sm2_verify(const uint8_t* public_key, unsigned long public_key_len,
                      const uint8_t* message, unsigned long message_len,
                      const uint8_t* signature, unsigned long signature_len);
int cosign_sm2_encrypt(const uint8_t* public_key, unsigned long public_key_len,
                       const uint8_t* message, unsigned long message_len,
                       uint8_t* out_ciphertext, unsigned long* out_len);
int cosign_sm2_decrypt(const uint8_t* private_key, unsigned long private_key_len,
                       const uint8_t* ciphertext, unsigned long ciphertext_len,
                       uint8_t* out_plaintext, unsigned long* out_len);</code></pre>

            <h3>é”™è¯¯ç å®šä¹‰</h3>
            <table>
                <tr><th>é”™è¯¯ç </th><th>è¯´æ˜</th></tr>
                <tr><td>0</td><td>æˆåŠŸ</td></tr>
                <tr><td>-1</td><td>ç©ºæŒ‡é’ˆé”™è¯¯</td></tr>
                <tr><td>-2</td><td>å‚æ•°æ— æ•ˆ</td></tr>
                <tr><td>-3</td><td>å¯†ç ç®—æ³•é”™è¯¯</td></tr>
                <tr><td>-4</td><td>ç½‘ç»œé”™è¯¯</td></tr>
                <tr><td>-5</td><td>ç¼–ç é”™è¯¯</td></tr>
            </table>
        </section>

        <section id="performance">
            <h2>âš¡ æ€§èƒ½æµ‹è¯•</h2>
            
            <h3>æµ‹è¯•ç¯å¢ƒ</h3>
            <ul>
                <li>CPU: Intel Core i7-10700 @ 2.9GHz</li>
                <li>å†…å­˜: 16GB DDR4</li>
                <li>æ“ä½œç³»ç»Ÿ: Ubuntu 22.04</li>
                <li>Rust: 1.70.0</li>
            </ul>

            <h3>æ€§èƒ½æ•°æ®</h3>
            <table>
                <tr><th>æ“ä½œ</th><th>è€—æ—¶</th><th>QPS</th></tr>
                <tr><td>SM3 å“ˆå¸Œ (1KB)</td><td>2.1 Î¼s</td><td>476,190</td></tr>
                <tr><td>SM2 ç­¾å</td><td>89.3 Î¼s</td><td>11,198</td></tr>
                <tr><td>SM2 éªŒç­¾</td><td>112.5 Î¼s</td><td>8,889</td></tr>
                <tr><td>SM2 åŠ å¯† (1KB)</td><td>156.2 Î¼s</td><td>6,402</td></tr>
                <tr><td>SM2 è§£å¯† (1KB)</td><td>134.8 Î¼s</td><td>7,418</td></tr>
                <tr><td>å¯†é’¥ç”Ÿæˆ</td><td>45.6 Î¼s</td><td>21,930</td></tr>
            </table>

            <h3>å†…å­˜å ç”¨</h3>
            <table>
                <tr><th>ç»„ä»¶</th><th>å†…å­˜å ç”¨</th></tr>
                <tr><td>åŠ¨æ€åº“</td><td>2.3 MB</td></tr>
                <tr><td>é™æ€åº“</td><td>1.8 MB</td></tr>
                <tr><td>è¿è¡Œæ—¶å†…å­˜</td><td>&lt; 1 MB</td></tr>
            </table>
        </section>

        <section id="security">
            <h2>ğŸ›¡ï¸ å®‰å…¨æœºåˆ¶</h2>
            
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>ğŸ”‘ å¯†é’¥åˆ†ç‰‡éš”ç¦»</h4>
                    <p>å®¢æˆ·ç«¯æŒæœ‰ D1ï¼ŒæœåŠ¡ç«¯æŒæœ‰ D2ï¼Œå®Œæ•´ç§é’¥ d = D1 Ã— D2 - 1 ä¸åœ¨ä»»ä½•ä¸€æ–¹å­˜å‚¨ã€‚</p>
                </div>
                <div class="feature-card">
                    <h4>ğŸ¦€ å†…å­˜å®‰å…¨</h4>
                    <p>çº¯ Rust å®ç°ï¼Œæ‰€æœ‰æƒç³»ç»Ÿä¿è¯èµ„æºæ­£ç¡®é‡Šæ”¾ï¼Œæ— å†…å­˜æ³„æ¼é£é™©ã€‚</p>
                </div>
                <div class="feature-card">
                    <h4>ğŸ² éšæœºæ•°å®‰å…¨</h4>
                    <p>ä½¿ç”¨å¯†ç å­¦å®‰å…¨éšæœºæ•°ç”Ÿæˆå™¨ï¼Œæ¯æ¬¡ç­¾åä½¿ç”¨ä¸åŒçš„éšæœºæ•°ã€‚</p>
                </div>
                <div class="feature-card">
                    <h4>ğŸ” ä¼ è¾“å®‰å…¨</h4>
                    <p>æ•æ„Ÿæ•°æ®ä½¿ç”¨ Base64 ç¼–ç ï¼Œç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨ HTTPSã€‚</p>
                </div>
            </div>

            <div class="warning-box">
                <strong>âš ï¸ å®‰å…¨å»ºè®®ï¼š</strong>
                <ul>
                    <li>ä¸è¦æ˜æ–‡å­˜å‚¨ç§é’¥åˆ†é‡ D1</li>
                    <li>ç”Ÿäº§ç¯å¢ƒå¿…é¡»ä½¿ç”¨ HTTPS</li>
                    <li>å®šæœŸæ›´æ¢å¯†é’¥å¯¹</li>
                    <li>å¦¥å–„ä¿ç®¡ .d1 æ–‡ä»¶</li>
                </ul>
            </div>
        </section>

        <section id="license">
            <h2>ğŸ“„ è®¸å¯è¯</h2>
            <p>æœ¬é¡¹ç›®é‡‡ç”¨ <a href="https://opensource.org/licenses/MIT">MIT License</a> è®¸å¯è¯ã€‚</p>
            
            <h3>ç›¸å…³é“¾æ¥</h3>
            <p>
                <a href="https://github.com/kintaiW/sm2-co-sign-client" class="btn">GitHub ä»“åº“</a>
                <a href="https://github.com/kintaiW/sm2-co-sign" class="btn btn-outline">ä¸»é¡¹ç›®</a>
                <a href="https://github.com/kintaiW/sm2-co-sign-server" class="btn btn-outline">æœåŠ¡ç«¯</a>
                <a href="TECH_NOTES.md" class="btn btn-outline">æŠ€æœ¯ç¬”è®°</a>
            </p>
        </section>
    </div>

    <footer>
        <p>&copy; 2024-2026 SM2 Co-Sign Team. MIT License</p>
        <p>
            <a href="https://github.com/kintaiW/sm2-co-sign-client">GitHub</a> | 
            <a href="https://github.com/kintaiW/sm2-co-sign-client/issues">Issues</a>
        </p>
    </footer>
</body>
</html>
